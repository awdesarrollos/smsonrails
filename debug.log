# Logfile created on Sat Apr 25 21:52:07 -0700 2009 by /
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.0ms)[0m   [0mCREATE TABLE `schema_migrations` (`version` varchar(255) NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (44.3ms)[0m   [0;1mCREATE UNIQUE INDEX `unique_schema_migrations` ON `schema_migrations` (`version`)[0m
  [4;35;1mSQL (0.9ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSmsOnRails::Inbound Columns (34.5ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (27.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (4.0ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (21.0ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.1ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (13.4ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (93.7ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (3.1ms)[0m   [0mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;36;1mSQL (8.0ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (17.6ms)[0m   [0;1mDROP TABLE `sms_drafts`[0m
  [4;35;1mSQL (3.1ms)[0m   [0mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` int(11) DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (3.0ms)[0m   [0mDROP TABLE `sms_outbounds`[0m
  [4;36;1mSQL (3.4ms)[0m   [0;1mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` int(11) DEFAULT 0 NOT NULL, `sub_status` varchar(255), `notes` varchar(255), `created_at` datetime, `processed_on` datetime, `lock_version` int(11) DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;35;1mSQL (6.2ms)[0m   [0mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (7.2ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;35;1mSQL (8.7ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;36;1mSQL (15.8ms)[0m   [0;1mCREATE INDEX `idx_sms_outbounds_status_priority_draft` ON `sms_outbounds` (`status`, `send_priority`, `sms_draft_id`)[0m
  [4;35;1mSQL (8.4ms)[0m   [0mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.2ms)[0m   [0mDROP TABLE `sms_inbounds`[0m
  [4;36;1mSQL (2.7ms)[0m   [0;1mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` int(11)) ENGINE=InnoDB[0m
  [4;35;1mSQL (9.6ms)[0m   [0mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (12.7ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;35;1mSQL (6.4ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;36;1mSQL (9.6ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSmsOnRails::Inbound Columns (3.5ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (2.2ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (2.5ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.3ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (36.4ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (9.0ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.4ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (3.3ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (9.2ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.9ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (2.9ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` int(11) DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (2.8ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` int(11) DEFAULT 0 NOT NULL, `sub_status` varchar(255), `notes` varchar(255), `created_at` datetime, `processed_on` datetime, `lock_version` int(11) DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (9.6ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (10.0ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (10.3ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (7.9ms)[0m   [0mCREATE INDEX `idx_sms_outbounds_status_priority_draft` ON `sms_outbounds` (`status`, `send_priority`, `sms_draft_id`)[0m
  [4;36;1mSQL (9.1ms)[0m   [0;1mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.7ms)[0m   [0;1mDROP TABLE `sms_inbounds`[0m
  [4;35;1mSQL (3.3ms)[0m   [0mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (9.8ms)[0m   [0;1mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (6.3ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;36;1mSQL (8.2ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;35;1mSQL (9.5ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (3.1ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (2.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.6ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (27.1ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (6.1ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.0ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (2.8ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (7.6ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.9ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (3.7ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` int(11) DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.1ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (3.3ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` int(11) DEFAULT 0 NOT NULL, `sub_status` varchar(255), `notes` varchar(255), `created_at` datetime, `processed_on` datetime, `lock_version` int(11) DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (6.8ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (6.7ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (9.1ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (15.3ms)[0m   [0mCREATE INDEX `idx_sms_outbounds_status_priority_draft` ON `sms_outbounds` (`status`, `send_priority`, `sms_draft_id`)[0m
  [4;36;1mSQL (9.4ms)[0m   [0;1mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mDROP TABLE `sms_inbounds`[0m
  [4;35;1mSQL (2.2ms)[0m   [0mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (5.5ms)[0m   [0;1mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (8.2ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;36;1mSQL (7.9ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;35;1mSQL (6.6ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.8ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.4ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (23.5ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255), `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (7.6ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.8ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (4.1ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (9.5ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.7ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (4.9ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` int(11) DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (0.6ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (2.4ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(255) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` int(11) DEFAULT 0 NOT NULL, `sub_status` varchar(255), `notes` varchar(255), `created_at` datetime, `processed_on` datetime, `lock_version` int(11) DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (7.5ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (5.9ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (7.0ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (11.0ms)[0m   [0mCREATE INDEX `idx_sms_outbounds_status_priority_draft` ON `sms_outbounds` (`status`, `send_priority`, `sms_draft_id`)[0m
  [4;36;1mSQL (6.6ms)[0m   [0;1mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSQL (0.5ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.0ms)[0m   [0;1mDROP TABLE `sms_inbounds`[0m
  [4;35;1mSQL (2.2ms)[0m   [0mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` int(11)) ENGINE=InnoDB[0m
  [4;36;1mSQL (7.9ms)[0m   [0;1mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (8.0ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;36;1mSQL (10.1ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;35;1mSQL (8.3ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.6ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.9ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.2ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (3.7ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.8ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.1ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (3.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:26')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.2ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-26 10:21:26'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (1.2ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '', NULL, 0, NULL)[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 2, 0, NULL, 3, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-26 10:21:26'
 WHERE id = 3
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: exc.to_s', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 3
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (1.0ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.2ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.1ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.9ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.4ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 12) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.7ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.9ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 8, 0, NULL, 4, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 15, 0, NULL, 4, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.3ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 8) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 15) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.7ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (1.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:26')[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 5, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 6, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-26 10:21:26'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"4923:20090426102126Z.316"}
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '4923:20090426102126Z.316', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-26 10:21:26'
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.7ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:26')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 7, NULL, 0, NULL, '2009-04-26 10:21:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-26 10:21:26'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"4923:20090426102127Z.15"}
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '4923:20090426102127Z.15', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-26 10:21:27'
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 16, 0, NULL, 7, NULL, 0, NULL, '2009-04-26 10:21:27')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-26 10:21:27'
 WHERE id = 10
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
SMS DUMMY: send_message("14155553456", "hi", {})
 RESPONSE:{:unique_id=>"4923:20090426102127Z.781"}
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `unique_id` = '4923:20090426102127Z.781', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-26 10:21:27'
 WHERE id = 10
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0;1mSELECT * FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:27', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:27')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 8, NULL, 0, NULL, '2009-04-26 10:21:27')[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:27', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:27')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 9, NULL, 0, NULL, '2009-04-26 10:21:27')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:27', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:27')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 10, NULL, 0, NULL, '2009-04-26 10:21:27')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.5ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 21) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 22[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-26 10:21:27', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:27', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:27')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 11, NULL, 0, NULL, '2009-04-26 10:21:27')[0m
  [4;35;1mSQL (0.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 22[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-26 10:21:29', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:29', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:29')[0m
  [4;35;1mSQL (1.4ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 23, 0, NULL, 12, NULL, 0, NULL, '2009-04-26 10:21:29')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-26 10:21:30', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:30', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:30')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 23, 0, NULL, 13, NULL, 0, NULL, '2009-04-26 10:21:30')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 23[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:30', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:30')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '', NULL, 0, NULL)[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 14, NULL, 0, NULL, '2009-04-26 10:21:30')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.5ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 25[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-26 10:21:30', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:30', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:30')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.2ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 25[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 15, NULL, 0, NULL, '2009-04-26 10:21:30')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 25)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 25)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 25[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-26 10:21:30', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:30', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:30')[0m
  [4;36;1mSQL (20.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 26[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 26, 0, NULL, 16, NULL, 0, NULL, '2009-04-26 10:21:31')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneCarrier Load (0.5ms)[0m   [0mSELECT * FROM `sms_phone_carriers` [0m
Sent mail to 2063512476@vtext.com

From: blythe@spongecell.com
To: 2063512476@vtext.com
Subject: Message from SmsOnRails
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

some test message 2009-04-26 10:21:30

  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-26 10:21:31', 'NOT_PROCESSED', NULL, '2009-04-26 10:21:31', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-26 10:21:31')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 26, 0, NULL, 17, NULL, 0, NULL, '2009-04-26 10:21:31')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 26)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 26)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 26[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.3ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (20.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.7ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (235.1ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (73.5ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (110.3ms)[0m   [0mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;36;1mSQL (125.7ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;35;1mSQL (1.2ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mDROP TABLE `sms_drafts`[0m
  [4;35;1mSQL (0.0ms)[0m   [0mMysql::Error: Invalid default value for 'status': CREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(10) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.7ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (89.3ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (94.8ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.2ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (83.9ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (103.8ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (102.4ms)[0m   [0mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.8ms)[0m   [0mDROP TABLE `sms_outbounds`[0m
  [4;36;1mSQL (106.8ms)[0m   [0;1mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` tinyint DEFAULT 0 NOT NULL, `sub_status` varchar(35), `notes` varchar(80), `created_at` datetime, `processed_on` datetime, `lock_version` tinyint DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;35;1mSQL (135.2ms)[0m   [0mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (78.0ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;35;1mSQL (74.4ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;36;1mSQL (101.6ms)[0m   [0;1mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSQL (1.3ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.5ms)[0m   [0;1mDROP TABLE `sms_inbounds`[0m
  [4;35;1mSQL (79.6ms)[0m   [0mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` tinyint) ENGINE=InnoDB[0m
  [4;36;1mSQL (166.7ms)[0m   [0;1mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (102.4ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;36;1mSQL (87.8ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;35;1mSQL (86.0ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (15.6ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.2ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.1ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.1ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.6ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:04:04'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.5ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.9ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.7ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (1.0ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.6ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 7, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.3ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 7) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 5, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 6, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:04:04'
 WHERE id = 7
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9866:20090427210404Z.74"}
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '9866:20090427210404Z.74', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:04:04'
 WHERE id = 7
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Delete all (3.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:04:04'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9866:20090427210404Z.873"}
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '9866:20090427210404Z.873', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:04:04'
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 15, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:04:04'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
SMS DUMMY: send_message("14155553456", "hi", {})
 RESPONSE:{:unique_id=>"9866:20090427210404Z.723"}
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `unique_id` = '9866:20090427210404Z.723', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:04:04'
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 8, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 9, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 10, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.6ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 16) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 21[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:04:04', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:04', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 21, 0, NULL, 11, NULL, 0, NULL, '2009-04-27 21:04:04')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 21[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:04:08', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:08', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:08')[0m
  [4;35;1mSQL (1.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 12, NULL, 0, NULL, '2009-04-27 21:04:08')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:04:09', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:09', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:09')[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 13, NULL, 0, NULL, '2009-04-27 21:04:09')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 22[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:09', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:09')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.6ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 23[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:04:09', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:09', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:09')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 23[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (2.0ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 23, 0, NULL, 15, NULL, 0, NULL, '2009-04-27 21:04:09')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 23[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:04:09', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:09', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:09')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 24[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 16, NULL, 0, NULL, '2009-04-27 21:04:09')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneCarrier Load (0.5ms)[0m   [0mSELECT * FROM `sms_phone_carriers` [0m
Sent mail to 2063512476@vtext.com

From: blythe@spongecell.com
To: 2063512476@vtext.com
Subject: Message from SmsOnRails
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

some test message 2009-04-27 21:04:09

  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:04:09', 'NOT_PROCESSED', NULL, '2009-04-27 21:04:09', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:04:09')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 17, NULL, 0, NULL, '2009-04-27 21:04:09')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 24[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (23.6ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (72.1ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (205.2ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.4ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (186.5ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (72.8ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.6ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (90.9ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (0.8ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.2ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (106.1ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` tinyint DEFAULT 0 NOT NULL, `sub_status` varchar(35), `notes` varchar(80), `created_at` datetime, `processed_on` datetime, `lock_version` tinyint DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (127.6ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (96.8ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (111.5ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (109.9ms)[0m   [0mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.8ms)[0m   [0mDROP TABLE `sms_inbounds`[0m
  [4;36;1mSQL (112.7ms)[0m   [0;1mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` tinyint) ENGINE=InnoDB[0m
  [4;35;1mSQL (104.1ms)[0m   [0mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (122.8ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;35;1mSQL (119.3ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;36;1mSQL (90.6ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSmsOnRails::Inbound Columns (3.6ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (2.5ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (2.0ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (5.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (7.7ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (1.0ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:06:03'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.9ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.1ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 2) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.8ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 7, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 7) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 5, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 6, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:06:03'
 WHERE id = 7
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9868:20090427210603Z.647"}
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '9868:20090427210603Z.647', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:06:03'
 WHERE id = 7
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (1.3ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.7ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:06:03'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9868:20090427210603Z.336"}
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '9868:20090427210603Z.336', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:06:03'
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 15, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:06:03'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
SMS DUMMY: send_message("14155553456", "hi", {})
 RESPONSE:{:unique_id=>"9868:20090427210603Z.326"}
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `unique_id` = '9868:20090427210603Z.326', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:06:03'
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0;1mSELECT * FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.2ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 8, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 9, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 10, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.6ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.8ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 16) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 21[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:06:03', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:03', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 21, 0, NULL, 11, NULL, 0, NULL, '2009-04-27 21:06:03')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 21[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:06:06', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:06', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:06')[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 12, NULL, 0, NULL, '2009-04-27 21:06:06')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:06:07', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:07')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 13, NULL, 0, NULL, '2009-04-27 21:06:07')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 22[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:07')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('10000555888')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '10000555888', NULL, 0, NULL)[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 23, 0, NULL, 14, NULL, 0, NULL, '2009-04-27 21:06:07')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 24[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:06:07', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:07')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 24[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 15, NULL, 0, NULL, '2009-04-27 21:06:07')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 24[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:06:07', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:07')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 25[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 16, NULL, 0, NULL, '2009-04-27 21:06:07')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneCarrier Load (0.5ms)[0m   [0mSELECT * FROM `sms_phone_carriers` [0m
Sent mail to 2063512476@vtext.com

From: blythe@spongecell.com
To: 2063512476@vtext.com
Subject: Message from SmsOnRails
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

some test message 2009-04-27 21:06:07

  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:06:07', 'NOT_PROCESSED', NULL, '2009-04-27 21:06:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:06:07')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 17, NULL, 0, NULL, '2009-04-27 21:06:07')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 25)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 25)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 25[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (21.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Draft Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `sms_drafts`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:12:17', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:12:17')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('666555')) [0m
  [4;35;1mSmsOnRails::PhoneNumber Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `phone_numbers`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '666555', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 26, 0, NULL, 18, NULL, 0, NULL, '2009-04-27 21:12:17')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.6ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.8ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Draft Columns (3.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_drafts`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:12:46', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:12:46')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('666555')) [0m
  [4;35;1mSmsOnRails::PhoneNumber Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `phone_numbers`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 26, 0, NULL, 19, NULL, 0, NULL, '2009-04-27 21:12:46')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.1ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (10.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Draft Columns (3.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_drafts`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:13:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:13:14')[0m
  [4;35;1mSQL (2.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;35;1mSmsOnRails::PhoneNumber Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `phone_numbers`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (3.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (25.5ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 16, 0, NULL, 21, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 21, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 28, 0, NULL, 21, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (1.1ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 27) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 21) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 16) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 21) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 28) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 21) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 22, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 27) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 22) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 23, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:15:05'
 WHERE id = 26
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9881:20090427211505Z.54"}
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `unique_id` = '9881:20090427211505Z.54', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:15:05'
 WHERE id = 26
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 24, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:15:05'
 WHERE id = 27
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9881:20090427211505Z.712"}
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `unique_id` = '9881:20090427211505Z.712', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:15:05'
 WHERE id = 27
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 29, 0, NULL, 24, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:15:05'
 WHERE id = 28
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("14155553456", "hi", {})
 RESPONSE:{:unique_id=>"9881:20090427211505Z.723"}
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '9881:20090427211505Z.723', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:15:05'
 WHERE id = 28
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 25, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 26, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 27, NULL, 0, NULL, '2009-04-27 21:15:05')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:05')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.7ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (2.4ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.0ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:37', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:37')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (4.2ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 29, NULL, 0, NULL, '2009-04-27 21:15:37')[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 32
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:37', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:37')[0m
  [4;36;1mSQL (2.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 30, NULL, 0, NULL, '2009-04-27 21:15:37')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 33
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:15:37'
 WHERE id = 33
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:15:37', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:15:37')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (65.8ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:16:35', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:16:35')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 32, NULL, 0, NULL, '2009-04-27 21:16:35')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 34
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.2ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:16:35', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:16:35')[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (3.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 33, NULL, 0, NULL, '2009-04-27 21:16:35')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (1.0ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 35
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:16:35'
 WHERE id = 35
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:16:35', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:16:35')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('00000')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '00000', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 30, 0, NULL, 34, NULL, 0, NULL, '2009-04-27 21:16:35')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:16:35'
 WHERE id = 36
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("00000", "hi", {})
 RESPONSE:{:unique_id=>"9886:20090427211635Z.261"}
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '9886:20090427211635Z.261', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:16:35'
 WHERE id = 36
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.0ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (3.7ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (12.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:18:39', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:18:39')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 35, NULL, 0, NULL, '2009-04-27 21:18:39')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 37
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:18:39', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:18:39')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 36, NULL, 0, NULL, '2009-04-27 21:18:39')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.7ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.6ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 38
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:18:39'
 WHERE id = 38
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.7ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (4.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.8ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:18:52', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:18:52')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 37, NULL, 0, NULL, '2009-04-27 21:18:52')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 39
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:18:52', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:18:52')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 38, NULL, 0, NULL, '2009-04-27 21:18:52')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (1.2ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 40
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:18:52'
 WHERE id = 40
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
fatal fatal error in SmsOnRails::Outbound
Couldn't find SmsOnRails::Outbound without an ID
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.0ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (3.3ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.4ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.5ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:20:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:20:07')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (1.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 39, NULL, 0, NULL, '2009-04-27 21:20:07')[0m
  [4;35;1mSQL (2.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 41
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:20:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:20:07')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (6.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 40, NULL, 0, NULL, '2009-04-27 21:20:08')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 42
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (1.8ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:20:08'
 WHERE id = 42
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.4ms)[0m   [0mROLLBACK[0m
fatal fatal error in SmsOnRails::Outbound
Couldn't find SmsOnRails::Outbound without an ID
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.7ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (3.8ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.4ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:23:45', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:23:45')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 41, NULL, 0, NULL, '2009-04-27 21:23:45')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 43
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:23:45', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:23:45')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 42, NULL, 0, NULL, '2009-04-27 21:23:45')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 44
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:23:45'
 WHERE id = 44
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.5ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (21.7ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:24:34', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:24:34')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 43, NULL, 0, NULL, '2009-04-27 21:24:34')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 45
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:24:34', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:24:34')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 44, NULL, 0, NULL, '2009-04-27 21:24:34')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.2ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 46
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:24:34'
 WHERE id = 46
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.1ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.3ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (2.5ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:24:58', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:24:58')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 45, NULL, 0, NULL, '2009-04-27 21:24:58')[0m
  [4;35;1mSQL (1.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 47
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.9ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:24:58', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:24:58')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 46, NULL, 0, NULL, '2009-04-27 21:24:58')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 48
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:24:58'
 WHERE id = 48
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (11.7ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:25:43', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:25:43')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 47, NULL, 0, NULL, '2009-04-27 21:25:43')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 49
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:25:43', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:25:43')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 48, NULL, 0, NULL, '2009-04-27 21:25:43')[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 50
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:25:43'
 WHERE id = 50
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:25:43', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:25:43')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 49, NULL, 0, NULL, '2009-04-27 21:25:43')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (5.8ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.1ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:26:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:26:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 50, NULL, 0, NULL, '2009-04-27 21:26:14')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.7ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 52
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:26:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:26:14')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 51, NULL, 0, NULL, '2009-04-27 21:26:14')[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 53
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:26:14'
 WHERE id = 53
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:26:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:26:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 52, NULL, 0, NULL, '2009-04-27 21:26:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.1ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (3.3ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (3.6ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.4ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.2ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:27:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:27:07')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 53, NULL, 0, NULL, '2009-04-27 21:27:07')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 55
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:27:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:27:07')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (4.9ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.7ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 54, NULL, 0, NULL, '2009-04-27 21:27:07')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (1.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 56
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:27:07'
 WHERE id = 56
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:27:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:27:07')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 55, NULL, 0, NULL, '2009-04-27 21:27:07')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.5ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:28:13', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:28:13')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 56, NULL, 0, NULL, '2009-04-27 21:28:13')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 58
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:28:13', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:28:13')[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 57, NULL, 0, NULL, '2009-04-27 21:28:13')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 59
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:28:13'
 WHERE id = 59
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.0ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.2ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:28:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:28:47')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 58, NULL, 0, NULL, '2009-04-27 21:28:47')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 60
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:28:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:28:47')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 59, NULL, 0, NULL, '2009-04-27 21:28:47')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 61
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:28:47'
 WHERE id = 61
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.5ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:28:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:28:47')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 60, NULL, 0, NULL, '2009-04-27 21:28:47')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.0ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (4.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (19.4ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:29:31', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:29:31')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 61, NULL, 0, NULL, '2009-04-27 21:29:31')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 63
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:29:31', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:29:31')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 62, NULL, 0, NULL, '2009-04-27 21:29:31')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.6ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 64
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (1.0ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:29:31'
 WHERE id = 64
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:29:31', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:29:31')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 63, NULL, 0, NULL, '2009-04-27 21:29:31')[0m
  [4;35;1mSQL (0.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (4.8ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.1ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:31:36', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:31:36')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 64, NULL, 0, NULL, '2009-04-27 21:31:36')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.9ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 66
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:31:36', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:31:36')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (1.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 65, NULL, 0, NULL, '2009-04-27 21:31:36')[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 67
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:31:36'
 WHERE id = 67
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:31:36', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:31:36')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 66, NULL, 0, NULL, '2009-04-27 21:31:36')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:31:36'
 WHERE id = 68
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 68) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 68
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (7.4ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:05')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 67, NULL, 0, NULL, '2009-04-27 21:33:05')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 69
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:05')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 68, NULL, 0, NULL, '2009-04-27 21:33:05')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 70
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:05'
 WHERE id = 70
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:05', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:05')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 69, NULL, 0, NULL, '2009-04-27 21:33:05')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:05'
 WHERE id = 71
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 71) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 71
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.0ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (6.2ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.2ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.4ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:23', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:23')[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 70, NULL, 0, NULL, '2009-04-27 21:33:23')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.8ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 72
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.5ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:23', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:23')[0m
  [4;36;1mSQL (2.4ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (3.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 71, NULL, 0, NULL, '2009-04-27 21:33:23')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 73
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:23'
 WHERE id = 73
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:23', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:23')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 27, 0, NULL, 72, NULL, 0, NULL, '2009-04-27 21:33:23')[0m
  [4;35;1mSQL (1.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:23'
 WHERE id = 74
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 74) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 74
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (38.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (3.0ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (87.1ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (231.4ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (1.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.6ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (73.2ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (115.0ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.5ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (89.5ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (1.0ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (94.6ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` tinyint DEFAULT 0 NOT NULL, `sub_status` varchar(35), `notes` varchar(80), `created_at` datetime, `processed_on` datetime, `lock_version` tinyint DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (125.7ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (98.8ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (87.5ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (76.2ms)[0m   [0mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.0ms)[0m   [0mDROP TABLE `sms_inbounds`[0m
  [4;36;1mSQL (94.1ms)[0m   [0;1mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` tinyint) ENGINE=InnoDB[0m
  [4;35;1mSQL (177.3ms)[0m   [0mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (133.9ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;35;1mSQL (111.7ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;36;1mSQL (101.1ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSmsOnRails::Inbound Columns (3.2ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (2.2ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (2.3ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.1ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.5ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.1ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.9ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (1.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (1.2ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (1.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:42'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 3, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.5ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:42'
 WHERE id = 3
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.2ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 3
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.8ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (1.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.8ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 7, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.6ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.8ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 7) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.3ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 5, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 6, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:42'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.2ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.4ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.7ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:33:42'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 9) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 8, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.8ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 9, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 10, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.2ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 16) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 21[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:33:42', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:42', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 21, 0, NULL, 12, NULL, 0, NULL, '2009-04-27 21:33:42')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 21[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.5ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:33:44', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:44', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:44')[0m
  [4;35;1mSQL (2.4ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 13, NULL, 0, NULL, '2009-04-27 21:33:45')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:33:45', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:45', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:45')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 14, NULL, 0, NULL, '2009-04-27 21:33:45')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 22[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (6.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 23[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:33:47', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:47')[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 23[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 23, 0, NULL, 15, NULL, 0, NULL, '2009-04-27 21:33:47')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 23[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:33:47', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:47')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.6ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 24[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 16, NULL, 0, NULL, '2009-04-27 21:33:47')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneCarrier Load (0.3ms)[0m   [0mSELECT * FROM `sms_phone_carriers` [0m
Sent mail to 2063512476@vtext.com

From: blythe@spongecell.com
To: 2063512476@vtext.com
Subject: Message from SmsOnRails
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

some test message 2009-04-27 21:33:47

  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:33:47', 'NOT_PROCESSED', NULL, '2009-04-27 21:33:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:33:47')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 17, NULL, 0, NULL, '2009-04-27 21:33:47')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.1ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 24[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.4ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (86.6ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (138.8ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.4ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (100.1ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (103.2ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.5ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (90.6ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (0.8ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (94.4ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` tinyint DEFAULT 0 NOT NULL, `sub_status` varchar(35), `notes` varchar(80), `created_at` datetime, `processed_on` datetime, `lock_version` tinyint DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (104.6ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (98.8ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (98.8ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (87.7ms)[0m   [0mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.5ms)[0m   [0mDROP TABLE `sms_inbounds`[0m
  [4;36;1mSQL (80.9ms)[0m   [0;1mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` tinyint) ENGINE=InnoDB[0m
  [4;35;1mSQL (93.7ms)[0m   [0mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (87.1ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;35;1mSQL (96.7ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;36;1mSQL (113.2ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSmsOnRails::Inbound Columns (3.3ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (1.7ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.1ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (3.3ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (5.1ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.5ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.9ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.0ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (1.1ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.7ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (1.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.5ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (1.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:34:14'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 3, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:34:14'
 WHERE id = 3
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 3
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.7ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.1ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (1.0ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.8ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (1.4ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.4ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 7, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 7) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 5, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.9ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.3ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 6, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:34:14'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.5ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:34:14'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 9) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.9ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 8, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 9, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 10, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.5ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 16) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.8ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 21[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:34:14', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:14', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 21, 0, NULL, 12, NULL, 0, NULL, '2009-04-27 21:34:14')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.5ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.4ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 21[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.1ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.9ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (3.7ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.4ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:46', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:46')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.7ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 13, NULL, 0, NULL, '2009-04-27 21:34:46')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.7ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 14
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (1.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.7ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:46', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:46')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 14, NULL, 0, NULL, '2009-04-27 21:34:46')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 15
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:34:46'
 WHERE id = 15
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (1.0ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:34:46', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:34:46')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 15, NULL, 0, NULL, '2009-04-27 21:34:46')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:34:46'
 WHERE id = 16
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 16) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 16
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.3ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (12.5ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.1ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:18', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:18')[0m
  [4;36;1mSQL (1.4ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.8ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 16, NULL, 0, NULL, '2009-04-27 21:35:19')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 17
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.5ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:19', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:19')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 17, NULL, 0, NULL, '2009-04-27 21:35:19')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 18
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:35:19'
 WHERE id = 18
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:19', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:19')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 18, NULL, 0, NULL, '2009-04-27 21:35:19')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:35:19'
 WHERE id = 19
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (1.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 19) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 19
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.8ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (130.4ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (114.7ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.6ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (71.0ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (93.6ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.0ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (77.8ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (0.9ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.9ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (93.1ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` tinyint DEFAULT 0 NOT NULL, `sub_status` varchar(35), `notes` varchar(80), `created_at` datetime, `processed_on` datetime, `lock_version` tinyint DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (115.7ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (97.7ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (99.6ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (120.2ms)[0m   [0mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.9ms)[0m   [0mDROP TABLE `sms_inbounds`[0m
  [4;36;1mSQL (90.2ms)[0m   [0;1mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` tinyint) ENGINE=InnoDB[0m
  [4;35;1mSQL (102.9ms)[0m   [0mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (99.9ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;35;1mSQL (89.7ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;36;1mSQL (86.3ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSmsOnRails::Inbound Columns (3.3ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (2.2ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (1.6ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (4.5ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.8ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.9ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.6ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:35:26'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 3, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:35:26'
 WHERE id = 3
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 3
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.3ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.6ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.6ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.9ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.1ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.2ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 7, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (1.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 7) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 5, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.3ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 6, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:35:26'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 8) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.6ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (2.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.8ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:35:26'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 9) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.4ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 8, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 9, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.2ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 10, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.9ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (1.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 16) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 21[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:35:26', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:26', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 21, 0, NULL, 12, NULL, 0, NULL, '2009-04-27 21:35:26')[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 21[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.9ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:35:29', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:29', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:29')[0m
  [4;35;1mSQL (1.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 13, NULL, 0, NULL, '2009-04-27 21:35:29')[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.6ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:35:30', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:30', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:30')[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 14, NULL, 0, NULL, '2009-04-27 21:35:30')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 22[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 23[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:35:31', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:31', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:31')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 23[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 23, 0, NULL, 15, NULL, 0, NULL, '2009-04-27 21:35:31')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 23[0m
  [4;35;1mSQL (1.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:35:31', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:31', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:31')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (1.5ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.6ms)[0m   [0;1mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 24[0m
  [4;35;1mSQL (4.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (6.0ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 16, NULL, 0, NULL, '2009-04-27 21:35:31')[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneCarrier Load (0.4ms)[0m   [0mSELECT * FROM `sms_phone_carriers` [0m
Sent mail to 2063512476@vtext.com

From: blythe@spongecell.com
To: 2063512476@vtext.com
Subject: Message from SmsOnRails
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

some test message 2009-04-27 21:35:31

  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.5ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:35:31', 'NOT_PROCESSED', NULL, '2009-04-27 21:35:31', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:35:31')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 17, NULL, 0, NULL, '2009-04-27 21:35:31')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 24[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.3ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.7ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (96.0ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.4ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:07')[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (1.4ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 18, NULL, 0, NULL, '2009-04-27 21:37:07')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 19
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.5ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:07')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 19, NULL, 0, NULL, '2009-04-27 21:37:07')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 20
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:07'
 WHERE id = 20
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.6ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:07', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:07')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 20, NULL, 0, NULL, '2009-04-27 21:37:07')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:07'
 WHERE id = 21
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 21) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 21
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.0ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (3.9ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (1.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.4ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.3ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:22', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:22')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 21, NULL, 0, NULL, '2009-04-27 21:37:22')[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 22
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.8ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:22', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:22')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 22, NULL, 0, NULL, '2009-04-27 21:37:22')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 23
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:22'
 WHERE id = 23
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:22', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:22')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 23, NULL, 0, NULL, '2009-04-27 21:37:22')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:22'
 WHERE id = 24
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 24) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 24
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.8ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (3.0ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.2ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (3.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (3.4ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:39', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:39')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 24, NULL, 0, NULL, '2009-04-27 21:37:39')[0m
  [4;35;1mSQL (0.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.6ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 25
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:39', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:39')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.8ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 25, NULL, 0, NULL, '2009-04-27 21:37:39')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 26
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:39'
 WHERE id = 26
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:39', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:39')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 25, 0, NULL, 26, NULL, 0, NULL, '2009-04-27 21:37:39')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.6ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:39'
 WHERE id = 27
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 27) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 27
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.3ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (136.2ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (225.5ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.6ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (84.1ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (102.6ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (1.0ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.7ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (90.8ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (1.4ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (94.0ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` tinyint DEFAULT 0 NOT NULL, `sub_status` varchar(35), `notes` varchar(80), `created_at` datetime, `processed_on` datetime, `lock_version` tinyint DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (125.8ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (121.9ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (99.4ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (88.4ms)[0m   [0mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSQL (1.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.8ms)[0m   [0mDROP TABLE `sms_inbounds`[0m
  [4;36;1mSQL (69.1ms)[0m   [0;1mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` tinyint) ENGINE=InnoDB[0m
  [4;35;1mSQL (131.3ms)[0m   [0mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (483.8ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;35;1mSQL (554.2ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;36;1mSQL (82.1ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSmsOnRails::Inbound Columns (3.2ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (3.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (2.7ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.4ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (2.9ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (2.4ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.2ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.5ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (2.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:47')[0m
  [4;36;1mSQL (1.3ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (1.0ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.1ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (1.0ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (2.3ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.6ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (1.1ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:48'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (1.0ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 3, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:48'
 WHERE id = 3
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 3) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 3
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.0ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.4ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 2) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (1.4ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.2ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.5ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (1.1ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 7, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 7) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.3ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 5, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.3ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.9ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 6, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:48'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (17.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.4ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 8) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (1.2ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.8ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:37:48'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.5ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 9) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.7ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.5ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 8, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 9, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 10, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (1.6ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (1.0ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 16) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.2ms)[0m   [0mROLLBACK[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mROLLBACK[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 21[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:37:48', 'NOT_PROCESSED', NULL, '2009-04-27 21:37:48', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 21, 0, NULL, 12, NULL, 0, NULL, '2009-04-27 21:37:48')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.5ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 21[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.4ms)[0m   [0mDROP TABLE `sms_phone_carriers`[0m
  [4;36;1mSQL (85.7ms)[0m   [0;1mCREATE TABLE `sms_phone_carriers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `name` varchar(255) NOT NULL, `email_domain` varchar(255), `notes` varchar(255), `options` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (163.7ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_carriers_name` ON `sms_phone_carriers` (`name`)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.7ms)[0m   [0mDROP TABLE `phone_numbers`[0m
  [4;36;1mSQL (69.8ms)[0m   [0;1mCREATE TABLE `phone_numbers` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `number` varchar(255) NOT NULL, `carrier_id` int(11), `owner_id` int(11), `white_list` tinyint(1) DEFAULT 0 NOT NULL, `do_not_send` varchar(255), `country_code` int(11) DEFAULT 1) ENGINE=InnoDB[0m
  [4;35;1mSQL (104.2ms)[0m   [0mCREATE UNIQUE INDEX `uk_phone_numbers_number` ON `phone_numbers` (`number`)[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (2.2ms)[0m   [0mDROP TABLE `sms_drafts`[0m
  [4;36;1mSQL (90.9ms)[0m   [0;1mCREATE TABLE `sms_drafts` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `message` varchar(255), `header` varchar(255), `footer` varchar(255), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `deliver_after` datetime, `delivery_date` datetime, `sender_id` int(11), `lock_version` tinyint DEFAULT 0 NOT NULL, `options` varchar(255), `updated_at` varchar(255), `created_at` varchar(255)) ENGINE=InnoDB[0m
  [4;35;1mSQL (1.2ms)[0m   [0mSHOW TABLES[0m
  [4;36;1mSQL (2.3ms)[0m   [0;1mDROP TABLE `sms_outbounds`[0m
  [4;35;1mSQL (82.8ms)[0m   [0mCREATE TABLE `sms_outbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_phone_number_id` int(11) NOT NULL, `sms_draft_id` int(11), `status` varchar(15) DEFAULT 'NOT_PROCESSED' NOT NULL, `retry_count` tinyint DEFAULT 0 NOT NULL, `sub_status` varchar(35), `notes` varchar(80), `created_at` datetime, `processed_on` datetime, `lock_version` tinyint DEFAULT 0 NOT NULL, `sms_service_provider_id` int(11), `options` varchar(255), `send_priority` int(11) DEFAULT 0 NOT NULL) ENGINE=InnoDB[0m
  [4;36;1mSQL (91.1ms)[0m   [0;1mALTER TABLE sms_outbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;35;1mSQL (89.6ms)[0m   [0mCREATE UNIQUE INDEX `uk_sms_outbounds_unique_id` ON `sms_outbounds` (`unique_id`)[0m
  [4;36;1mSQL (76.2ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_outbounds_draft_phone_number` ON `sms_outbounds` (`sms_draft_id`, `sms_phone_number_id`)[0m
  [4;35;1mSQL (78.8ms)[0m   [0mCREATE INDEX `index_sms_outbounds_on_sms_phone_number_id` ON `sms_outbounds` (`sms_phone_number_id`)[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mSHOW TABLES[0m
  [4;35;1mSQL (1.6ms)[0m   [0mDROP TABLE `sms_inbounds`[0m
  [4;36;1mSQL (80.0ms)[0m   [0;1mCREATE TABLE `sms_inbounds` (`id` int(11) DEFAULT NULL auto_increment PRIMARY KEY, `sms_draft_id` int(11), `sms_phone_number_id` int(11) NOT NULL, `created_at` datetime, `sent_at` datetime, `message` datetime, `sms_service_provider_id` tinyint) ENGINE=InnoDB[0m
  [4;35;1mSQL (91.7ms)[0m   [0mALTER TABLE sms_inbounds ADD COLUMN `unique_id` varchar(255) character set latin1 collate latin1_bin default NULL[0m
  [4;36;1mSQL (88.5ms)[0m   [0;1mCREATE UNIQUE INDEX `uk_sms_inboundes_unique_id` ON `sms_inbounds` (`unique_id`)[0m
  [4;35;1mSQL (107.4ms)[0m   [0mCREATE INDEX `index_sms_inbounds_on_sms_draft_id` ON `sms_inbounds` (`sms_draft_id`)[0m
  [4;36;1mSQL (90.5ms)[0m   [0;1mCREATE INDEX `index_sms_inbounds_on_sms_phone_number_id` ON `sms_inbounds` (`sms_phone_number_id`)[0m
  [4;35;1mSmsOnRails::Inbound Columns (3.3ms)[0m   [0mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;36;1mSmsOnRails::Outbound Columns (2.4ms)[0m   [0;1mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Columns (2.5ms)[0m   [0mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.4ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::Inbound Columns (4.2ms)[0m   [0;1mSHOW FIELDS FROM `sms_inbounds`[0m
  [4;35;1mSmsOnRails::Outbound Columns (7.1ms)[0m   [0mSHOW FIELDS FROM `sms_outbounds`[0m
  [4;36;1mSmsOnRails::PhoneCarrier Columns (2.3ms)[0m   [0;1mSHOW FIELDS FROM `sms_phone_carriers`[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (0.3ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mSET NAMES 'utf8'[0m
  [4;35;1mSQL (0.1ms)[0m   [0mSET SQL_AUTO_IS_NULL=0[0m
  [4;36;1mSmsOnRails::PhoneCarrier Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_phone_carriers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mSET NAMES 'utf8'[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mSET SQL_AUTO_IS_NULL=0[0m
  [4;35;1mSmsOnRails::PhoneCarrier Delete all (1.6ms)[0m   [0mDELETE FROM `sms_phone_carriers` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSmsOnRails::Draft Columns (1.8ms)[0m   [0mSHOW FIELDS FROM `sms_drafts`[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:40', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:40')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.7ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Columns (2.0ms)[0m   [0;1mSHOW FIELDS FROM `phone_numbers`[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 1, NULL, 0, NULL, '2009-04-27 21:38:40')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1
 WHERE id = 1
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:40', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:40')[0m
  [4;35;1mSQL (0.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.7ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 2, NULL, 0, NULL, '2009-04-27 21:38:40')[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'something fun', `lock_version` = 1
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:38:40'
 WHERE id = 2
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mROLLBACK[0m
SmsOnRails::Outbound lock failed
Attempted to update a stale object
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:40', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:40')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 1, 0, NULL, 3, NULL, 0, NULL, '2009-04-27 21:38:40')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:38:40'
 WHERE id = 3
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `notes` = 'FAILED: asdf', `status` = 'FAILED', `lock_version` = 2
 WHERE id = 3
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.9ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.5ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 2) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.9ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 3) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.6ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 4) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 5) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 6) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (1.3ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSmsOnRails::PhoneNumber Delete all (0.5ms)[0m   [0mDELETE FROM `phone_numbers` [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 7) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 8) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 9) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 10) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 11) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065554444','442065553333','14155554444')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (1.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.6ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('multi test', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:40', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:40')[0m
  [4;35;1mSQL (1.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','12065551234','14155551234')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155551234', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (1.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 7, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:38:40')[0m
  [4;35;1mSQL (0.9ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:38:40')[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 14, 0, NULL, 4, NULL, 0, NULL, '2009-04-27 21:38:40')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065551234') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 7) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.2ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '14155551234') LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Load (0.2ms)[0m   [0mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 14) LIMIT 1[0m
  [4;36;1mSmsOnRails::Draft Load (0.2ms)[0m   [0;1mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 4) [0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.3ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:40', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:40')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 5, NULL, 0, NULL, '2009-04-27 21:38:40')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`number` = '12065552476') LIMIT 1[0m
  [4;36;1mSmsOnRails::Outbound Load (0.3ms)[0m   [0;1mSELECT * FROM `sms_outbounds` WHERE (`sms_outbounds`.`sms_phone_number_id` = 13) LIMIT 1[0m
  [4;35;1mSmsOnRails::Draft Load (0.2ms)[0m   [0mSELECT * FROM `sms_drafts` WHERE (`sms_drafts`.`id` = 5) [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.0ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:40', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:40')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 6, NULL, 0, NULL, '2009-04-27 21:38:41')[0m
  [4;35;1mSQL (1.0ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:38:41'
 WHERE id = 8
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9936:20090427213841Z.521"}
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `unique_id` = '9936:20090427213841Z.521', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:38:41'
 WHERE id = 8
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::Outbound Load (0.5ms)[0m   [0;1mSELECT * FROM `sms_outbounds` LIMIT 1[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.8ms)[0m   [0mDELETE FROM `sms_outbounds` [0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('hi', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:41', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:41')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476','14155553456')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '14155553456', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:38:41')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.5ms)[0m   [0m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:38:41'
 WHERE id = 9
 AND `lock_version` = 0
[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
SMS DUMMY: send_message("12065552476", "hi", {})
 RESPONSE:{:unique_id=>"9936:20090427213841Z.825"}
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `unique_id` = '9936:20090427213841Z.825', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:38:41'
 WHERE id = 9
 AND `lock_version` = 1
[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 15, 0, NULL, 7, NULL, 0, NULL, '2009-04-27 21:38:41')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Update with optimistic locking (0.4ms)[0m   [0;1m UPDATE `sms_outbounds`
 SET `status` = 'PROCESSING', `lock_version` = 1, `retry_count` = 1, `processed_on` = '2009-04-27 21:38:41'
 WHERE id = 10
 AND `lock_version` = 0
[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
SMS DUMMY: send_message("14155553456", "hi", {})
 RESPONSE:{:unique_id=>"9936:20090427213841Z.142"}
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Update with optimistic locking (0.3ms)[0m   [0m UPDATE `sms_outbounds`
 SET `unique_id` = '9936:20090427213841Z.142', `status` = 'PROCESSED', `lock_version` = 2, `sms_service_provider_id` = 2, `processed_on` = '2009-04-27 21:38:41'
 WHERE id = 10
 AND `lock_version` = 1
[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::Outbound Load (0.6ms)[0m   [0mSELECT * FROM `sms_outbounds` [0m
  [4;36;1mSmsOnRails::Outbound Delete all (1.1ms)[0m   [0;1mDELETE FROM `sms_outbounds` [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('$TIME$', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:41', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:41')[0m
  [4;35;1mSQL (1.2ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 8, NULL, 0, NULL, '2009-04-27 21:38:41')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone: $PHONE_NUMBER_DIGITS$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:41', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:41')[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 9, NULL, 0, NULL, '2009-04-27 21:38:41')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('Format phone human: $PHONE_NUMBER$ end', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:41', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:41')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12065552476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 13, 0, NULL, 10, NULL, 0, NULL, '2009-04-27 21:38:41')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Delete all (0.8ms)[0m   [0;1mDELETE FROM `phone_numbers` [0m
  [4;35;1mSQL (0.6ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551234', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 16) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065551235', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 17) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065552222', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 18) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.2ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '442065553333', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 19) [0m
  [4;35;1mSQL (0.8ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12065554444', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (`phone_numbers`.`id` = 20) [0m
  [4;35;1mSQL (0.5ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.4ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message #{Time.now.to_s(:db)}', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:41', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:41')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mROLLBACK[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.2ms)[0m   [0;1mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 21[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.2ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:38:41', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:41', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:41')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 21, 0, NULL, 12, NULL, 0, NULL, '2009-04-27 21:38:41')[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.3ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 21)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 21[0m
  [4;35;1mSQL (1.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:38:45', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:45', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:45')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (1.1ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.6ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 13, NULL, 0, NULL, '2009-04-27 21:38:45')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:38:46', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:46', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:46')[0m
  [4;35;1mSQL (1.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.5ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 22, 0, NULL, 14, NULL, 0, NULL, '2009-04-27 21:38:46')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.4ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 22)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.3ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 22[0m
  [4;36;1mSQL (0.7ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Create (0.4ms)[0m   [0mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0;1mUPDATE `phone_numbers` SET `do_not_send` = 'bounce' WHERE `id` = 23[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:38:47', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:47')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.2ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.3ms)[0m   [0mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 23[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 23, 0, NULL, 15, NULL, 0, NULL, '2009-04-27 21:38:47')[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.4ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Delete all (0.6ms)[0m   [0mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;36;1mSmsOnRails::Inbound Delete all (0.2ms)[0m   [0;1mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 23)) [0m
  [4;35;1mSmsOnRails::PhoneNumber Destroy (0.2ms)[0m   [0mDELETE FROM `phone_numbers` WHERE `id` = 23[0m
  [4;36;1mSQL (0.6ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.1ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Draft Create (0.3ms)[0m   [0;1mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:38:47', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:47')[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneNumber Load (0.6ms)[0m   [0;1mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;35;1mSQL (0.3ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::PhoneNumber Create (0.3ms)[0m   [0;1mINSERT INTO `phone_numbers` (`country_code`, `do_not_send`, `number`, `carrier_id`, `white_list`, `owner_id`) VALUES(1, NULL, '12063512476', NULL, 0, NULL)[0m
  [4;35;1mSQL (0.7ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.3ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::PhoneNumber Update (0.4ms)[0m   [0mUPDATE `phone_numbers` SET `carrier_id` = 1 WHERE `id` = 24[0m
  [4;36;1mSQL (0.9ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Create (0.4ms)[0m   [0;1mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 16, NULL, 0, NULL, '2009-04-27 21:38:47')[0m
  [4;35;1mSQL (0.8ms)[0m   [0mCOMMIT[0m
  [4;36;1mSmsOnRails::PhoneCarrier Load (0.4ms)[0m   [0;1mSELECT * FROM `sms_phone_carriers` [0m
Sent mail to 2063512476@vtext.com

From: blythe@spongecell.com
To: 2063512476@vtext.com
Subject: Message from SmsOnRails
Mime-Version: 1.0
Content-Type: text/plain; charset=utf-8

some test message 2009-04-27 21:38:47

  [4;35;1mSmsOnRails::PhoneNumber Load (0.4ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Draft Create (0.4ms)[0m   [0mINSERT INTO `sms_drafts` (`message`, `status`, `options`, `updated_at`, `delivery_date`, `lock_version`, `header`, `deliver_after`, `footer`, `sender_id`, `created_at`) VALUES('some test message 2009-04-27 21:38:47', 'NOT_PROCESSED', NULL, '2009-04-27 21:38:47', NULL, 0, NULL, NULL, NULL, NULL, '2009-04-27 21:38:47')[0m
  [4;36;1mSQL (1.2ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSmsOnRails::PhoneNumber Load (0.3ms)[0m   [0mSELECT * FROM `phone_numbers` WHERE (number in ('12063512476')) [0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSQL (0.1ms)[0m   [0mCOMMIT[0m
  [4;36;1mSQL (0.1ms)[0m   [0;1mBEGIN[0m
  [4;35;1mSmsOnRails::Outbound Create (0.3ms)[0m   [0mINSERT INTO `sms_outbounds` (`status`, `options`, `retry_count`, `unique_id`, `sms_service_provider_id`, `sms_phone_number_id`, `lock_version`, `notes`, `sms_draft_id`, `processed_on`, `send_priority`, `sub_status`, `created_at`) VALUES('NOT_PROCESSED', NULL, 0, NULL, NULL, 24, 0, NULL, 17, NULL, 0, NULL, '2009-04-27 21:38:47')[0m
  [4;36;1mSQL (0.8ms)[0m   [0;1mCOMMIT[0m
  [4;35;1mSQL (0.2ms)[0m   [0mBEGIN[0m
  [4;36;1mSmsOnRails::Outbound Delete all (0.5ms)[0m   [0;1mDELETE FROM `sms_outbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;35;1mSmsOnRails::Inbound Delete all (0.3ms)[0m   [0mDELETE FROM `sms_inbounds` WHERE ((sms_phone_number_id = 24)) [0m
  [4;36;1mSmsOnRails::PhoneNumber Destroy (0.4ms)[0m   [0;1mDELETE FROM `phone_numbers` WHERE `id` = 24[0m
  [4;35;1mSQL (0.6ms)[0m   [0mCOMMIT[0m
